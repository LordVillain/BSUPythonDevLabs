***

# Анализ набора данных "German Credit Data"

**Выполнил:** Ильинчик Даниил Александрович 
**Группа:** 4  
**Учебное заведение:** БГУ
**Факультет:** ФПМИ 
**Лабораторная работа №:** 3 
**Дата выполнения:** 02.12.2025

---

## 2. Введение

**Цель работы:** Проведение полного цикла анализа данных (ETL) набора "German Credit Data" для выявления ключевых факторов, влияющих на кредитный риск, а также закрепление навыков работы с библиотеками Python и языком SQL.

**Задачи:**
*   Загрузить и структурировать "сырые" данные.
*   Провести разведочный анализ данных (EDA).
*   Визуализировать распределения и взаимосвязи признаков.
*   Организовать хранение обработанных данных в реляционной базе данных (SQLite).

**Инструменты:** Python (pandas, matplotlib, seaborn, scikit-learn), SQLite.

---

## 3. Загрузка и подготовка данных

**Источник данных:**
Данные взяты из репозитория UCI Machine Learning Repository. Файл `german.data` не содержал заголовков, они были присвоены программно согласно официальной документации датасета.

**Структура данных:**
*   Количество наблюдений (строк): **1000**
*   Количество признаков (столбцов): **21** (7 числовых, 14 категориальных).

**Обработка пропущенных значений:**
В ходе проверки методом `.isnull().sum()` пропущенных значений в наборе данных **не обнаружено** (0 пропусков). Дополнительная импутация не потребовалась.

**Кодирование переменных:**
Исходные данные содержали закодированные значения (например, `A11`, `A34`).
1.  **Для аналитики и SQL:** Применено отображение (Mapping) через словарь для перевода кодов в человекочитаемый вид (например, `A34` -> `critical account`). Целевая переменная `1/2` преобразована в `Good/Bad`.
2.  **Для корреляционного анализа:** Категориальные строковые признаки были закодированы методом `Label Encoding` (преобразование в числа `0, 1, 2...`).

---

## 4. Анализ данных

**Числовые признаки (Статистика):**
*   **Возраст:** Средний возраст заемщика — **35.5 лет**. Минимальный — 19, максимальный — 75.
*   **Сумма кредита:** Средняя сумма — **3271 DM**. Медиана — 2319 DM. Это говорит о наличии "тяжелого хвоста" справа (выбросов в виде очень крупных кредитов до 18 424 DM).
*   **Длительность:** В среднем кредиты берутся на 21 месяц.

**Категориальные признаки:**
*   **Баланс классов (Credit Risk):**
    *   Good (Надежные): **70%** (700 чел.)
    *   Bad (Рискованные): **30%** (300 чел.)
    Выборка умеренно несбалансированная.

**Ключевые выводы:**
Большинство клиентов — молодые люди до 40 лет, берущие небольшие кредиты. Рискованная группа составляет треть выборки, что является значимым показателем для банковского дела.

---

## 5. Визуальный анализ

Для исследования были построены 4 типа графиков.

### 1. Распределение возраста
![Гистограмма возраста](output/figures/1_age_distribution.png)
*Интерпретация:* Распределение имеет правостороннюю асимметрию. Основная масса заемщиков находится в диапазоне 25–35 лет. После 40 лет кредитная активность резко снижается.

### 2. Зависимость суммы кредита от риска (Boxplot)
![Boxplot суммы](output/figures/2_amount_boxplot.png)
*Интерпретация:* Медианная сумма кредита у "плохих" заемщиков (Bad) выше, чем у "хороших". Также в категории "Bad" чаще встречаются экстремально большие суммы кредитов (выбросы в верхней части графика).

### 3. Цели кредитования (Countplot)
![Цели кредита](output/figures/3_purpose_counts.png)
*Интерпретация:* Самые популярные цели — покупка техники (радио/ТВ), новых автомобилей и мебели. Кредиты на переквалификацию (retraining) встречаются реже всего.

### 4. Корреляционная матрица
![Корреляция](output/figures/4_correlation.png)
*Интерпретация:*
*   Наблюдается сильная положительная корреляция между **суммой кредита** и его **длительностью** (около 0.62). Это логично: большие суммы требуют большего времени на возврат.
*   Корреляция между возрастом и суммой кредита очень слабая — размер кредита практически не зависит от возраста клиента.

---

## 6. Работа с базой данных SQLite

**Структура БД:**
В файле `credit_data.db` создана таблица `clients`, содержащая 1000 записей и 21 столбец.

**Примеры выполненных SQL-запросов:**

1.  **Анализ средних чеков (Агрегация):**
    *Запрос:* Расчет средней суммы кредита в разрезе целей.
    *Результат:* Наиболее крупные суммы берутся на категорию "others" (в среднем >8000 DM) и подержанные авто. На бытовую технику берут небольшие суммы (~2600 DM).

2.  **Сравнение профилей риска (Группировка):**
    *Запрос:* `SELECT credit_risk, AVG(age), AVG(amount)... GROUP BY credit_risk`
    *Результат:*
    *   **Good:** Средний возраст 36.2 года, средний кредит 2985 DM.
    *   **Bad:** Средний возраст 33.9 года, средний кредит 3938 DM.
    *Вывод:* "Плохие" заемщики в среднем моложе и просят суммы на ~1000 DM больше.

3.  **Влияние жилья (Многоуровневая группировка):**
    *Запрос:* Подсчет количества `Good` и `Bad` клиентов для каждого типа жилья (`own`, `rent`, `free`).
    *Результат:* Владельцы собственного жилья (`own`) составляют большинство. Интересно, что среди тех, кто живет бесплатно (`for free`), доля невозвратов визуально выше, чем у собственников.

4.  **Сложная выборка (Фильтрация):**
    *Запрос:* Поиск клиентов с плохой кредитной историей (`critical account`), которым одобрили крупные суммы (>5000 DM).
    *Результат:* Найдено несколько десятков таких случаев. Большинство из них имеют работу уровня "skilled employee" или "management", что, вероятно, послужило причиной одобрения, несмотря на историю.

---

## 7. Итоговые выводы

В ходе работы установлено:
1.  **Факторы риска:** Существует тенденция, что более высокие суммы кредитов и "нестандартные" цели (others) чаще связаны с риском невозврата.
2.  **Портрет клиента:** Типичный клиент — мужчина 30-35 лет, берущий ~2300 DM на покупку электроники или автомобиля сроком на 1.5 года.
3.  **Рекомендации:** Банку следует внимательнее проверять заявки на суммы выше 5000 DM, особенно если цель кредита не определена четко ("others"), так как средний чек в этой категории аномально высок.

---

## 8. Заключение

Цель лабораторной работы достигнута. Был реализован скрипт на Python, выполняющий автоматическую загрузку, очистку, визуализацию данных и экспорт в базу данных. Структура проекта разбита на модули, что обеспечивает масштабируемость кода.

**Дальнейшие направления:**
*   Применение алгоритмов машинного обучения для предсказания статуса `credit_risk`
*   Оборачивание модели прогнозирования в REST API
